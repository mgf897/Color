<!DOCTYPE html>
<html lang="en">
<head>

  <!-- Basic Page Needs
  Framework docs
  http://getskeleton.com/
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta charset="utf-8">
  <title>Mindfulness Coloring</title>
  <meta name="description" content="Free Mindfulness Coloring Book Online">
  <meta name="author" content="Matt Flynn">

  <!-- Mobile Specific Metas
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta name="viewport" content="width=device-width, initial-scale=">

  <!-- FONT
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link href="//fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet" type="text/css">

  <!-- CSS
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link rel="stylesheet" href="css/normalize.css">
  <link rel="stylesheet" href="css/skeleton.css">
  <link rel="stylesheet" href="myStyle.css">

  <!-- Favicon
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link rel="icon" type="image/png" href="images/favicon.png">
  <script src="fabric.min.js"></script>
  <script src="jquery-2.1.4.min.js"></script>

<script>

var imageURL = 'images/img1.png';
var n = 0;
var canvas;
var currentImg;
var brushColor = "#1abc9c";
var c01;
var c02;
var c03;
var c04;
	
window.onload = function(){
	scaleCanvas();

	c01 = document.getElementById('c01');
	c02 = document.getElementById('c02');
	c03 = document.getElementById('c03');
	c04 = document.getElementById('c04');
	
	canvas = new fabric.Canvas('myCanvas');
	var paletteWidth = window.getComputedStyle(c01,null).getPropertyValue("width");
	var colorBoxes = document.getElementsByClassName('colorbox');
	
	[].forEach.call(colorBoxes, function (colorBox) {
		colorBox.height = paletteWidth;
		console.log(colorBox.height + " "+ paletteWidth);
	});
	
	
	$('#brushSize input:radio').addClass('input_hidden');
	$('#brushSize label').click(function(){
		$(this).addClass('selected').siblings().removeClass('selected');
	});
	
	canvas.isDrawingMode = true;
	canvas.freeDrawingBrush.color = brushColor;
	canvas.freeDrawingBrush.width = 10;

	c01.onclick = function(){
		brushColor = window.getComputedStyle(c01,null).getPropertyValue("background-color");
		updateBrushColor();	
	};
	c02.onclick = function(){
		brushColor = window.getComputedStyle(c02,null).getPropertyValue("background-color");
		updateBrushColor();	
	};
	c03.onclick = function(){
		brushColor = window.getComputedStyle(c03,null).getPropertyValue("background-color");
		updateBrushColor();	
	};
	c04.onclick = function(){
		brushColor = window.getComputedStyle(c04,null).getPropertyValue("background-color");
		updateBrushColor();	
	};
	c05.onclick = function(){
		brushColor = window.getComputedStyle(c05,null).getPropertyValue("background-color");
		updateBrushColor();	
	};
	c06.onclick = function(){
		brushColor = window.getComputedStyle(c06,null).getPropertyValue("background-color");
		updateBrushColor();	
	};
	c07.onclick = function(){
		brushColor = window.getComputedStyle(c07,null).getPropertyValue("background-color");
		updateBrushColor();	
	};
	c08.onclick = function(){
		brushColor = window.getComputedStyle(c08,null).getPropertyValue("background-color");
		updateBrushColor();	
	};
	c09.onclick = function(){
		brushColor = window.getComputedStyle(c09,null).getPropertyValue("background-color");
		updateBrushColor();	
	};
	c10.onclick = function(){
		brushColor = window.getComputedStyle(c10,null).getPropertyValue("background-color");
		updateBrushColor();	
	};
	c11.onclick = function(){
		brushColor = window.getComputedStyle(c11,null).getPropertyValue("background-color");
		updateBrushColor();	
	};
	c12.onclick = function(){
		brushColor = window.getComputedStyle(c12,null).getPropertyValue("background-color");
		updateBrushColor();	
	};
	c13.onclick = function(){
		brushColor = window.getComputedStyle(c13,null).getPropertyValue("background-color");
		updateBrushColor();	
	};
	c14.onclick = function(){
		brushColor = window.getComputedStyle(c14,null).getPropertyValue("background-color");
		updateBrushColor();	
	};
	c15.onclick = function(){
		brushColor = window.getComputedStyle(c15,null).getPropertyValue("background-color");
		updateBrushColor();	
	};
	c16.onclick = function(){
		brushColor = window.getComputedStyle(c16,null).getPropertyValue("background-color");
		updateBrushColor();	
	};
	c17.onclick = function(){
		brushColor = window.getComputedStyle(c17,null).getPropertyValue("background-color");
		updateBrushColor();	
	};
	c18.onclick = function(){
		brushColor = window.getComputedStyle(c18,null).getPropertyValue("background-color");
		updateBrushColor();	
	};
	c19.onclick = function(){
		brushColor = window.getComputedStyle(c19,null).getPropertyValue("background-color");
		updateBrushColor();	
	};
	c20.onclick = function(){
		brushColor = window.getComputedStyle(c20,null).getPropertyValue("background-color");
		updateBrushColor();	
	};
	
	fabric.Image.fromURL(imageURL, function(oImg){
			canvas.calcOffset();
			var yScale = canvas.height/oImg.height;
			var xScale = canvas.width/oImg.width;
			oImg.scale(Math.max(yScale,xScale));
			currentImg = oImg;
			drawOverlay();
		});
	
	canvas.on('mouse:up', function(options) {
		n++;
		console.log(n);
		drawOverlay();
	});
};

function drawOverlay(){
	canvas.remove(currentImg);
	canvas.add(currentImg);
	canvas.renderAll();
};
	
function OnChange(imageSelection){
	canvas.clear().renderAll();
	console.log(imageSelection);
	imageURL = "images/"+imageSelection+".png";
	fabric.Image.fromURL(imageURL, function(oImg){
			canvas.calcOffset();
			var yScale = canvas.height/oImg.height;
			var xScale = canvas.width/oImg.width;
			oImg.scale(Math.max(yScale,xScale));
			currentImg = oImg;
			drawOverlay();
		});
};

function scaleCanvas(){
	var canvas = document.getElementById("myCanvas");
	canvas.width = document.getElementById("canvas_cont").offsetWidth;
	canvas.height = canvas.width * 0.8;
};

function updateBrushColor(){
	canvas.freeDrawingBrush.color = brushColor;
	console.log(brushColor);
};

</script>
</head>
<body>

  <!-- Primary Page Layout
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
<div class="container">
	<div class="row" id="header">
		<div class="twelve columns">
			<h1>Mindfulness Coloring</h1>
		</div>
	</div>
	<div class="row">
		<div class="two columns">
			<select name="select" onchange='OnChange(this.value);'>
				<option value="img1">Image 1</option>
				<option value="img2">Image 2</option>
				<option value="img3">Image 3</option>
				<option value="img4">Image 4</option>
			</select>
			<div id="brushSize">
				<input type="radio" name="brushSize" id="smallBrush" />
				<label for="smallBrush"><img class="brushImg" src="images/brushSmall.png" alt="small" /></label>
				<input type="radio" name="brushSize" id="mediumBrush" />
				<label for="mediumBrush"><img class="brushImg" src="images/brushMedium.png" alt="medium" /></label>
				<input type="radio" name="brushSize" id="largeBrush" />
				<label for="largeBrush"><img class="brushImg" src="images/brushLarge.png" alt="large" /></label>
			</div>
			
			
			<div class="colorbox" id="c01"></div>
			<div class="colorbox" id="c02"></div>
			<div class="colorbox" id="c03"></div>
			<div class="colorbox" id="c04"></div>
			<div class="colorbox" id="c05"></div>
			<div class="colorbox" id="c06"></div>
			<div class="colorbox" id="c07"></div>
			<div class="colorbox" id="c08"></div>
			<div class="colorbox" id="c09"></div>
			<div class="colorbox" id="c10"></div>
			<div class="colorbox" id="c11"></div>
			<div class="colorbox" id="c12"></div>
			<div class="colorbox" id="c13"></div>
			<div class="colorbox" id="c14"></div>
			<div class="colorbox" id="c15"></div>
			<div class="colorbox" id="c16"></div>
			<div class="colorbox" id="c17"></div>
			<div class="colorbox" id="c18"></div>
			<div class="colorbox" id="c19"></div>
			<div class="colorbox" id="c20"></div>
			
		</div>
		<div class="eight columns" id="canvas_cont">
		<canvas id="myCanvas"></canvas>

		</div>
		<div class="two columns" id="ads">
			<h4>Ads</h4>
			<img src="images/book.jpg" width="200px"></img>
			Buy it on Amazon
		</div>
	</div>
</div>

<!-- End Document
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
</body>
</html>
